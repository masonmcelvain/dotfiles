# Bash aliases defined by Mason

if type eza &> /dev/null; then
   alias xls='/usr/bin/ls'
   alias ls='eza'
fi
alias ll='ls -alF'
alias la='ls -a'
alias resource="source ~/.bashrc"

alias g=git
alias pn=pnpm

alias hxg='hx $(git diff --name-only)'
alias tp='mkdir -p ~/.hx-scratch && hx-theme.sh papercolor-light ~/.hx-scratch/$(date +%Y-%m-%d_%H%M%S).md'
alias np='hx-theme.sh papercolor-light ~/notepad.md'
alias sss='ss -tlpn'

btail() {
    (tail -f "$@" | bat --decorations=never --paging=never -l log)
}

# alacritty compatibility with ssh
# https://github.com/alacritty/alacritty/issues/3962#issuecomment-1006832313
alias ssh='TERM=xterm-256color ssh'

# Zellij
alias zj="zellij"
alias zjn="zellij --layout ~/.config/zellij/layout.kdl"

# Show timestamp next to commands in `history`
# https://www.linuxuprising.com/2019/07/bash-history-how-to-show-timestamp-when.html
export HISTTIMEFORMAT="%F %T "

# Use vim for `fc`
export FCEDIT=vim

alias python="python3"
alias py="python3"

chr() {
  [ "$1" -lt 256 ] || return 1
  printf "\\$(printf '%03o' "$1")"
}
ord() {
  LC_CTYPE=C printf '%d' "'$1"
}

FZF_DEFAULT_OPTS='-m --height 40% --layout=reverse --border --ansi'
export FZF_DEFAULT_OPTS=$FZF_DEFAULT_OPTS'
  --color=fg:#5c6a72,fg+:#a6b0a0,bg:#fdf6e3,bg+:#f4f0d9
  --color=hl:#35a77c,hl+:#3a94c5,info:#708089,marker:#8da101
  --color=prompt:#f85552,spinner:#df69ba,pointer:#df69ba,header:#93b259
  --color=border:#829181,label:#829181,query:#939f91
  --border="rounded" --border-label="" --preview-window="border-rounded" --prompt="> "
  --marker=">" --pointer="◆" --separator="─" --scrollbar="│"'
if type fd &> /dev/null; then
{{ if eq .chezmoi.hostname "mason-xps" }}
   export FZF_DEFAULT_COMMAND='fd --type f --strip-cwd-prefix --follow --exclude .git --color=always'
{{ else }}
   export FZF_DEFAULT_COMMAND='fd --type f --follow --exclude .git --color=always'
{{- end }}
fi

{{ if eq .chezmoi.hostname "mason-xps" -}}
#------------------------------------------------------------------------------
# Local
#------------------------------------------------------------------------------
alias update="
   sudo apt update
   sudo apt upgrade
   sudo snap refresh
   sudo flatpak update --assumeyes
   sudo apt autoremove"
alias work="ssh -A cominor"
alias gg="git grep -I --line-number --color=always"

alias malware-scan="sudo clamscan --max-filesize=3999M --max-scansize=3999M --exclude-dir=/sys/* -i -r /"
alias which-clam="ps ax | grep [c]lamd"

# Enable fzf for bash
source /usr/share/doc/fzf/examples/key-bindings.bash
#------------------------------------------------------------------------------
{{- end }}

{{ if eq .chezmoi.hostname "cominor" -}}
#------------------------------------------------------------------------------
# Cominor
#------------------------------------------------------------------------------
alias code="cd /home/mmcelvain/Code"
alias mycli="mycli -u root -h db.cominor.com"
alias psalm="psalm --no-cache"
alias psalmup="psalm --update-baseline"
alias psalmset="psalm --set-baseline=psalm-baseline.xml"
alias list-prime='list-machines | rg worker-prime | rg --color=never -o "ec2-\S*"'
xbug() {
   XDEBUG_SESSION=1 "$@"
}

lmg () {
   live_ssh "$(list-machines | rg "$1" | awk 'NR==1 {print $11}')"
}

# Enable fzf for bash
if [[ ! (-z "$PS1")  ]] && [ -f ~/.fzf-key-bindings.bash  ]; then
   source /home/mmcelvain/.fzf-key-bindings.bash
fi
#------------------------------------------------------------------------------
{{- end }}
